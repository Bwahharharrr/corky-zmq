# Logrotate configuration for Corky ZMQ Service
# This file should be placed in /etc/logrotate.d/

# Match all log files in the .corky/logs directory
/home/*/.corky/logs/*.log {
    # Rotate logs daily
    daily
    # Keep 7 days of logs
    rotate 7
    # Compress the logs
    compress
    # Don't compress the most recently rotated log file until the next rotation
    delaycompress
    # Don't panic if the log file is missing
    missingok
    # Don't rotate empty log files
    notifempty
    # Create new log files with specific permissions
    create 0644 root root
    # Use date as suffix for rotated files
    dateext
    # Date format for rotated files
    dateformat -%Y%m%d
    # Script to run after rotation
    postrotate
        # Signal the service to reopen log files if needed
        # This assumes systemd is being used
        systemctl --user kill -s SIGHUP corky-zmq.service >/dev/null 2>&1 || true
    endscript
}
